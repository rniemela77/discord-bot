import{z as k,m as f,u as y,r as i,n as S,q as b,x as o,o as d,c as m,a as t,t as n,k as w,w as T,e as g,v as x,f as B,i as N}from"./index.12f74801.js";import{F as V}from"./FormTemplate.b186e581.js";const D={key:0},M=t("h1",null,"Task:",-1),U=["onSubmit"],q=t("label",{for:"status"},"Status",-1),F=["disabled"],z=["disabled"],C={key:1},W={name:"TaskView",setup(E){const p=k(),r=f(),h=y(),l=i(Number(p.params.id)),s=i("initial"),u=i(""),a=S(()=>r.tasks.find(e=>e.id===l.value)),v=async()=>{s.value="sending";try{await r.completeTask(l.value,u.value).catch(e=>{console.error(e)})}catch(e){e.value=e.message,s.value="initial";return}s.value="success",N.push("/")};return b(async()=>{await r.getTasksByUser(h.username).catch(e=>{console.error(e)})}),(e,c)=>o(a)?(d(),m("div",D,[M,t("h2",null,n(o(a).name),1),t("p",null,n(o(a).description),1),t("p",null,"Watching: "+n(o(a).watchedBy),1),t("p",null,"Due: "+n(o(a).time)+" on "+n(o(a).date),1),w(V,{status:s.value},{default:T(()=>[t("form",{onSubmit:B(v,["prevent"])},[q,g(t("textarea",{type:"text",id:"status","onUpdate:modelValue":c[0]||(c[0]=_=>u.value=_),placeholder:"Tell your watchers what you've done",disabled:s.value==="sending",required:""},null,8,F),[[x,u.value]]),t("button",{type:"submit",disabled:s.value==="sending"},"Send",8,z)],40,U)]),_:1},8,["status"])])):(d(),m("div",C,"No task found"))}};export{W as default};
